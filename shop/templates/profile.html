{% block content %}
     {% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Profile</title>
</head>
<style>
.outer-table {
    font-family: 'Open Sans', Helvetica;
    color: #efefef; /* Default text color */
    margin: 0 auto;
    width: 98%;

    border-collapse: separate;
    border-spacing: 0;
    border: 12px solid #003665;
    border-radius: 10px;
    overflow: hidden;
}

.outer-table th, .outer-table .td-outer {
    padding: 1em;
    width: 10em;
    border: 1px solid #003665;

}

.outer-table th, .outer-table .tr-outer .td-outer:first-child {
    background: linear-gradient(145deg, #e6e6e6, #ffffff);
    color: #003665;
}

.outer-table th:first-child {
    border-top-left-radius: 10px;

}
.outer-table .tr-outer:last-child .td-outer:first-child{
    border-bottom-left-radius: 10px;
}
.outer-table th:last-child {
    border-top-right-radius: 10px;
}
.outer-table tr:last-child .td-outer:last-child{
     border-bottom-right-radius: 10px;
}
.outer-table .tr-outer:nth-child(2n+3) {
    background: #fff;
}

.outer-table .td-outer:not(:first-child) {
    color: #464646;
}

.outer-table .td-outer:first-child, .outer-table th:first-child {
    width: 40px;
}

.outer-table {
    font-family: 'Open Sans', Helvetica;
    color: #efefef; /* Default text color */
    margin: 0 auto;
    width: 98%;

    border-collapse: separate;
    border-spacing: 0;
    border: 12px solid #003665;
    border-radius: 10px;
    overflow: hidden;
    margin-bottom: 20px;
}

.outer-table th, .outer-table .td-outer {
    padding: 1em;
    width: 10em;
    border: 1px solid #003665;

}

.outer-table th, .outer-table .tr-outer .td-outer:first-child {
    background: linear-gradient(145deg, #e6e6e6, #ffffff);
    color: #003665;
}

.outer-table th:first-child {
    border-top-left-radius: 10px;

}
.outer-table .tr-outer:last-child .td-outer:first-child{
    border-bottom-left-radius: 10px;
}
.outer-table th:last-child {
    border-top-right-radius: 10px;
}
.outer-table tr:last-child .td-outer:last-child{
     border-bottom-right-radius: 10px;
}
.outer-table .tr-outer:nth-child(2n+3) {
    background: #fff;
}

.outer-table .td-outer:not(:first-child) {
    color: #464646;
}

.outer-table .td-outer:first-child, .outer-table th:first-child {
    width: 40px;
}

 {#{  HERE  }#}
.nested-table {
    font-family: 'Open Sans', Helvetica;
    color: #efefef; /* Default text color */
    margin: 0 auto;
    width: 98%;

    border-collapse: separate;
    border-spacing: 0;
    border: 1px solid #003665;
    border-radius: 10px;
    overflow: hidden;
}

.nested-table th, .nested-table td {
    padding: 1em;
    width: 10em;
    border: 1px solid #003665;

}

.nested-table th, .nested-table tr td:first-child {
    background: linear-gradient(145deg, #e6e6e6, #ffffff);
    color: #003665;
}

.nested-table th:first-child {
    border-top-left-radius: 10px;

}
.nested-table tr:last-child td:first-child{
    border-bottom-left-radius: 10px;
}
.nested-table th:last-child {
    border-top-right-radius: 10px;
}
.nested-table tr:last-child td:last-child{
     border-bottom-right-radius: 10px;
}
.nested-table tr:nth-child(2n+3) {
    background: #fff;
}

.nested-table td:not(:first-child) {
    color: #464646;
}

.nested-table td:first-child, .nested-table th:first-child {
    width: 40px;
}

.profile-section {
    padding: 20px 20px 20px 50px;
    background-color: #f0f0f0;
    border-bottom: 2px solid #ddd;
    margin-bottom: 20px;
    border-radius: 0px 0px 50px 50px;
}

.username {
    {#text-align: center;#}
    margin-bottom: 20px; /* Increased spacing below the username */
    font-size: 32px; /* Larger font size for prominence */
    color: #333;
    font-weight: 700;
}

.profile-details {
    display: flex;
    justify-content: center; /* Center the columns horizontally */
    flex-wrap: wrap; /* Allow the columns to wrap if needed */
}

.column {
    display: flex;
    flex-direction: column; /* Stack items vertically */
    {#align-items: center; /* Center items horizontally within the column */#}
    flex: 1; /* Each column takes up equal width */
    min-width: 250px; /* Minimum width for each column to prevent too much squeezing */
}

.profile-section h2, .profile-section h3 {
    margin: 5px 0; /* Reduced spacing for a tighter layout */
    color: #333;
}

.profile-section h2 {
    font-size: 18px;
}

.profile-section h3 {
    font-size: 16px; /* Slightly smaller font size for the user role if not admin */
}
.profile-labels{
    font-weight: 600;
    font-size: 20px;
}
{# .nested-table {#}
{#  font-family: 'Open Sans', Helvetica;#}
{#  color: #efefef; /* Default text color */#}
{#}#}
{##}
{#.nested-table tr:nth-child(2n) {#}
{#  background: #ecfffe; /* Even rows background */#}
{#}#}
{##}
{#.nested-table{#}
{#    width: 100%;#}
{#}#}
{#.nested-table th, .nested-table td {#}
{#  padding: 1em;#}
{#  width: 10em;#}
{#}#}
{##}
{#.nested-table th {#}
{#  background: #364ca2;#}
{#  color: #efefef;#}
{#}#}
{#.nested-table tr:nth-child(2n+1) {#}
{#  background: #e4ecff !important; /* Odd rows background, starting from the third */#}
{#}#}
{#.nested-table tr td:first-child {#}
  {#background: #000;#}
{#  color: #2d2d2d;#}
{#}#}
</style>
<body>
{% include 'base.html' %}
<div class="profile-section">
    <h1 class="username">{{ user.username }}</h1>
<hr>
    <div class="profile-details">
        <div class="column">
            <h2> <span class="profile-labels">Account email:</span>     {{ user.email }} </h2>
            <h2> <span class="profile-labels">Country:</span>     Italy </h2>
        </div>
        <div class="column">
            <h2> <span class="profile-labels">Agent number:</span>     ExampleNumber </h2>
            {% if user.username == 'westa_admin' %}
                <h2> <span class="profile-labels">Account role:</span>     admin </h2>
            {% else %}
                <h3> <span class="profile-labels">Account role: </span> user</h3>
            {% endif %}
        </div>
    </div>
</div>
{#<hr>#}
<h1 style="text-align: center"> Order history </h1>
<table class="outer-table" id="table-{{ user.email }}" style="border:1px solid" >
      <tr>
          <th> Order ID </th>
          <th> Products </th>
          <th> Date </th>
          <th> Status </th>
          <th> Total </th>
      </tr>
      {% for document in orders %}
          <div class="cart-icon" id="cart-icon">
              <tr class="tr-outer" id="content-{{ document.order_id }}">
                  <td class="td-outer">{{ document.order_id }}</td>
                  <td class="td-outer">
                      <span><i class="fa fa-arrow-right" id="arrow-icon-{{ document.order_id }}" aria-hidden="true"></i> <a data-order-id="{{ document.order_id }}" class="show-content" id="show-button-{{ document.order_id }}">Show</a></span>
                  </td>
                  <td class="td-outer">{{ document.date }}</td>
                  <td class="td-outer">{{ document.Status }}</td>
                  <td class="td-outer">€{{ document.sum }}</td>
              </tr>

          </div>
    {% endfor %}
</table>
</body>
<script>

let products = [];
document.addEventListener("DOMContentLoaded", function() {
    products = {{ products|safe }};
});
document.querySelectorAll('.show-content').forEach(button => {
    button.addEventListener('click', () => {
        let orderId = button.getAttribute('data-order-id');
        let arrow = document.getElementById('arrow-icon-' + orderId);
        var orderRow = document.getElementById('content-' + orderId);
        var table = orderRow.closest('table');
        var rowIndex = orderRow.rowIndex;

        var nextRow = table.rows[rowIndex + 1];
        if (nextRow && nextRow.classList.contains('nested-table-row')) {

            table.deleteRow(rowIndex + 1);
            arrow.classList.remove('fa-arrow-down');
            arrow.classList.add('fa-arrow-right');
            document.getElementById('show-button-' + orderId).innerText = "Show";
        } else {
            arrow.classList.remove('fa-arrow-right');
            arrow.classList.add('fa-arrow-down');
            document.getElementById('show-button-' + orderId).innerText = "Hide";

            var nestedTableRow = table.insertRow(rowIndex + 1);
            nestedTableRow.classList.add('nested-table-row');

            var indentCell = nestedTableRow.insertCell(0);
            indentCell.classList.add('td-outer');

            var nestedTableCell = nestedTableRow.insertCell(1);
            nestedTableCell.colSpan = "4";

            var nestedTable = document.createElement('table');
            nestedTable.classList.add('nested-table');
            var nestedTableContent = `
                <tr>
                    <th>Name</th>
                    <th>Image</th>
                    <th>Description</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Summary</th>
                    <th>In stock</th>
                </tr>`;
            products[orderId].forEach(function(product) {
                nestedTableContent += `
                    <tr>
                        <td>${product.name}</td>
                        <td style="text-align: center"> <img src="${product.image_url}" width="100" height="100"> </td>
                        <td>${product.description}</td>
                        <td>€${product.price}</td>
                        <td>${product.quantity}</td>
                        <td>€${(product.quantity * product.price).toFixed(1)}</td>
                        <td style="width: 10%; text-align: center" ><span style="font-size: 20px">&#10003;</span></td>
                    </tr>`;
            });
            nestedTable.innerHTML = nestedTableContent;
            nestedTableCell.appendChild(nestedTable);
        }
    });
});

</script>
</html>

{% endblock %}

